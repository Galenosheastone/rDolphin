{
    "collab_server" : "",
    "contents" : "\nlibrary(readr)\nlibrary(data.table)\nlibrary(mlbench)\nlibrary(caret)\n# load the data\n\ncontrol <- rfeControl(functions=rfFuncs, method=\"cv\", number=10)\n\nlibrary(readxl)\n# combined_mtbls374 <- as.data.frame(read_excel(\"~/combined_mtbls374.xlsx\"))\nlibrary(missForest)\nshift <- data.matrix(read_csv(\"C:/Bruker/TopSpin3.2/data/MTBLS374/data_analysis/output_info/shift.csv\")[,-1])\nfitting_error <- data.matrix(read_csv(\"C:/Bruker/TopSpin3.2/data/MTBLS374/data_analysis/output_info/fitting_error.csv\")[,-1])\nsignal_area_ratio <- data.matrix(read_csv(\"C:/Bruker/TopSpin3.2/data/MTBLS374/data_analysis/output_info/signal_area_ratio.csv\")[,-1])\nw=data.matrix(read_csv(\"C:/Bruker/TopSpin3.2/data/MTBLS374/data_analysis/output_info/shift.csv\")[,-1])\nw[signal_area_ratio<5]=NA\nw[fitting_error>0.15]=NA\nind=apply(w,2,function(x)length(which(is.na(x))))\n# shift_clean=shift[,ind<64]\nw_clean=w[,ind<40]\nshift[signal_area_ratio<5]=NA\nshift[fitting_error>0.15]=NA\nind=apply(shift,2,function(x)length(which(is.na(x))))\n# shift_clean=shift[,ind<64]\nshift_clean=shift[,ind<40]\ncolnames(shift_clean)=paste(colnames(w_clean),'shift',sep='_')\n\naa=fread(\"C:/Bruker/TopSpin3.2/data/MTBLS374/s_BoEfRTP2 Serum NMR.txt\")\naa=aa[which(!is.na(aa$`Factor Value[smoking status]`)),]\nmetadata=factor(aa$`Factor Value[smoking status]`)\ncombined_mtbls374=as.data.frame(cbind(w_clean[as.numeric(as.matrix(aa[,1])),],shift_clean[as.numeric(as.matrix(aa[,1])),]))\n# asd=apply(w_clean,2,function(x) wilcox.test(x[which(metadata[,1]=='Never Smoker')],x[which(metadata[,1]=='Smoker')])$p.value)\n# asd2=apply(shift_clean,2,function(x) wilcox.test(x[which(metadata[,1]=='Never Smoker')],x[which(metadata[,1]=='Smoker')])$p.value)\n# show(asd)\n# sort(asd)\n# sort(asd2)\n#\n#\n#\n#\n#\n#\n#\n# set.seed(7)\n# load the library\n\n\nmiss=missForest(data.matrix(combined_mtbls374))$ximp\nmiss2=scale(miss,center=T,scale=T)\nresults <- rfe(miss2, metadata, sizes=seq(5,50,5), rfeControl=control)\nprint(results)\n# list the chosen features\npredictors(results)\n# plot the results\n\nresults2 <- rfe(miss2[,1:(ncol(miss2)/2)], metadata, sizes=seq(5,ncol(miss2)/2,5), rfeControl=control)\nprint(results2)\n\n# list the chosen features\n# plot the results\n\nresults3 <- rfe(miss2[,(ncol(miss2)/2+1):(ncol(miss2))], metadata, sizes=seq(5,ncol(miss2)/2,5), rfeControl=control)\nprint(results3)\n\n# list the chosen features\n# plot the results\n\n\n\n\n\n\nshift <- data.matrix(read_csv(\"C:/Users/Usuario/Downloads/joj3_associated_data/shift.csv\")[,-1])\nfitting_error <- data.matrix(read_csv(\"C:/Users/Usuario/Downloads/joj3_associated_data/fitting_error.csv\")[,-1])\nsignal_area_ratio <- data.matrix(read_csv(\"C:/Users/Usuario/Downloads/joj3_associated_data/signal_area_ratio.csv\")[,-1])\nw=data.matrix(read_csv(\"C:/Users/Usuario/Downloads/joj3_associated_data/quantification.csv\")[,-1])\nw[signal_area_ratio<5]=NA\nw[fitting_error>0.15]=NA\nind=apply(w,2,function(x)length(which(is.na(x))))\n# shift_clean=shift[,ind<64]\nw_clean=w[,ind<40]\nshift[signal_area_ratio<5]=NA\nshift[fitting_error>0.15]=NA\nind=apply(shift,2,function(x)length(which(is.na(x))))\n# shift_clean=shift[,ind<64]\nshift_clean=shift[,ind<40]\nmetadata <- factor(as.vector(as.data.frame(read_csv(\"C:/Bruker/TopSpin3.2/data/MTBLS237/data_analysis/Metadata.csv\"))[,3]))\n#\n# asd=apply(w_clean,2,function(x) wilcox.test(x[which(metadata[,1]=='1')],x[which(metadata[,1]=='3')])$p.value)\n# asd2=apply(shift_clean,2,function(x) wilcox.test(x[which(metadata[,1]=='1')],x[which(metadata[,1]=='3')])$p.value)\n# sort(asd)\n# sort(asd2)\ncolnames(shift_clean)=paste(colnames(w_clean),'shift',sep='_')\n\ncombined_mtbls237=as.data.frame(cbind(metadata,w_clean,shift_clean))\nmiss=missForest(combined_mtbls237[,-1])$ximp\nmiss2=scale(miss,center=T,scale=T)\nresults <- rfe(miss2, metadata, sizes=seq(3,30,3), rfeControl=control)\n\n\nresults2 <- rfe(miss2[,1:(ncol(miss2)/2)], metadata, sizes=seq(3,30,3), rfeControl=control)\n# list the chosen features\n# plot the results\n\nresults3 <- rfe(miss2[,(ncol(miss2)/2+1):(ncol(miss2))], metadata, sizes=seq(3,30,3), rfeControl=control)\n# list the chosen features\n# plot the results\nplot(results, type=c(\"g\", \"o\"),main=\"Accuracy of classification of samples according to combined \\n shift and area data\",xlab=\"Number of variables chosen\")\nplot(results2, type=c(\"g\", \"o\"),main=\"Accuracy of classification of samples according to area data\",xlab=\"Number of variables chosen\")\nplot(results3, type=c(\"g\", \"o\"),main=\"Accuracy of classification of samples according to shift data\",xlab=\"Number of variables chosen\")\n\n\nshift <- data.matrix(read_csv(\"C:/Bruker/TopSpin3.2/data/MTBLS242_20170211_113451/data_analysis/output_info/shift.csv\")[,-1])\nfitting_error <- data.matrix(read_csv(\"C:/Bruker/TopSpin3.2/data/MTBLS242_20170211_113451/data_analysis/output_info/fitting_error.csv\")[,-1])\nsignal_area_ratio <- data.matrix(read_csv(\"C:/Bruker/TopSpin3.2/data/MTBLS242_20170211_113451/data_analysis/output_info/signal_area_ratio.csv\")[,-1])\nw=data.matrix(read_csv(\"C:/Bruker/TopSpin3.2/data/MTBLS242_20170211_113451/data_analysis/output_info/Area.csv\")[,-1])\nw[signal_area_ratio<5]=NA\nw[fitting_error>0.15]=NA\nind=apply(w,2,function(x)length(which(is.na(x))))\n# shift_clean=shift[,ind<64]\nw_clean=w[,ind<40]\nshift[signal_area_ratio<5]=NA\nshift[fitting_error>0.15]=NA\nind=apply(shift,2,function(x)length(which(is.na(x))))\n# shift_clean=shift[,ind<64]\nshift_clean=shift[,ind<40]\nmetadata <- factor(as.vector(as.data.frame(read_csv(\"C:/Bruker/TopSpin3.2/data/MTBLS242_20170211_113451/data_analysis/Metadata.csv\"))[,3]))\n\nasd=apply(w_clean,2,function(x) wilcox.test(x[which(metadata=='0')],x[which(metadata=='2')])$p.value)\nasd2=apply(shift_clean,2,function(x) wilcox.test(x[which(metadata=='0')],x[which(metadata=='2')])$p.value)\nsort(asd)\nsort(asd2)\ncolnames(shift_clean)=paste(colnames(w_clean),'shift',sep='_')\n\ncombined_mtbls242=as.data.frame(cbind(metadata,w_clean,shift_clean))\nmiss=missForest(combined_mtbls242[,-1])$ximp\nmiss2=scale(miss,center=T,scale=T)\nresults <- rfe(miss2, metadata, sizes=seq(3,30,3), rfeControl=control)\nprint(results)\n# list the chosen features\npredictors(results)\n# plot the results\nplot(results, type=c(\"g\", \"o\"))\n\nresults2 <- rfe(miss2[,1:(ncol(miss2)/2)], metadata, sizes=seq(3,30,3), rfeControl=control)\n# list the chosen features\n# plot the results\nplot(results2, type=c(\"g\", \"o\"))\n\nresults3 <- rfe(miss2[,(ncol(miss2)/2+1):(ncol(miss2))], metadata, sizes=seq(3,30,3), rfeControl=control)\n# list the chosen features\n# plot the results\nplot(results3, type=c(\"g\", \"o\"))\n\n\n",
    "created" : 1492701513713.000,
    "dirty" : true,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "983751449",
    "id" : "AE8430A6",
    "lastKnownWriteTime" : 1492701601,
    "last_content_update" : 1492701652162,
    "path" : "C:/Users/Usuario/Downloads/data_structure_combination.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}