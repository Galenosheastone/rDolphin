colnames(ks_p_vals__country)=c("Genomics","Metabolomics","Proteomics","Transcriptomics")
ks_citation=matrix(NA,6,4)
ks_if=matrix(NA,6,4)
dat=rbind(data.frame(read_csv("genomics_scopus_1.csv")),data.frame(read_csv("genomics_scopus_2.csv")))
dat=dat[!duplicated(dat),]
cit0 = data.frame(read_csv("genomics_citation_1.csv"))[-c(1:6),]
cit00 = data.frame(read_csv("genomics_citation_2.csv"))[-c(1:6),]
cit0=cit0[,c(1:7,ncol(cit0))]
cit00=cit00[,c(1:7,ncol(cit00))]
colnames(cit0)[c(2,8)]=colnames(cit00)[c(2,8)]=c('Title','Citation')
cit=rbind(cit0,cit00)
cit=cit[!duplicated(cit),]
genomics=merge(cit,dat,by='Title')
genomics$Citation=as.numeric(as.character(genomics$Citation))
dat2=allp[allp$doi %in% dat$DOI|allp$pmid %in% dat$PubMed.ID,]
dat2$citation=rep(NA,nrow(dat2))
for (i in seq(nrow(dat2))) {
lol=c(which(genomics$DOI==dat2$doi[i]),which(genomics$PubMed.ID==dat2$pmid[i]))
if (length(lol)>0) dat2$citation[i]=genomics$Citation[lol]
}
dat2=dat2[!is.na(dat2$citation),]
dat2$citation=as.numeric(as.character(dat2$citation))
first_quartile_citation=dat2[order(dat2$citation,decreasing=T)[1:round(1*nrow(dat2)/4)],]
second_quartile_citation=dat2[order(dat2$citation,decreasing=T)[round(1*nrow(dat2)/4+1):round(2*nrow(dat2)/4)],]
third_quartile_citation=dat2[order(dat2$citation,decreasing=T)[round(2*nrow(dat2)/4+1):round(3*nrow(dat2)/4)],]
fourth_quartile_citation=dat2[order(dat2$citation,decreasing=T)[round(3*nrow(dat2)/4+1):nrow(dat2)],]
dat2=allp[allp$doi %in% dat$DOI|allp$pmid %in% dat$PubMed.ID,]
dat2=dat2[dat2$journal %in% journal_if_information$ABBREV,]
dat2$IF=rep(NA,nrow(dat2))
journal_if_information$meanIF=rowMeans(apply(journal_if_information[,4:9],2,as.numeric),na.rm=T)
# journal_if_information$`2013/2014`=as.numeric(as.character(journal_if_information$`2013/2014`))
for (i in seq(nrow(dat2))) {
lol=which(journal_if_information$JOURNAL==dat2$journal[i])
if (length(lol)>0) dat2$IF[i]=journal_if_information$meanIF[lol]
}
dat2=dat2[!is.na(dat2$IF),]
dat2$IF=as.numeric(as.character(dat2$IF))
ind1=allp$doi %in% dat$DOI|allp$pmid %in% dat$PubMed.ID
ind1=which(allp$doi %in% dat$DOI|allp$pmid %in% dat$PubMed.ID==T)
ks_citation=matrix(NA,6,4)
ks_if=matrix(NA,6,4)
dat=rbind(data.frame(read_csv("genomics_scopus_1.csv")),data.frame(read_csv("genomics_scopus_2.csv")))
dat=dat[!duplicated(dat),]
cit0 = data.frame(read_csv("genomics_citation_1.csv"))[-c(1:6),]
cit00 = data.frame(read_csv("genomics_citation_2.csv"))[-c(1:6),]
cit0=cit0[,c(1:7,ncol(cit0))]
cit00=cit00[,c(1:7,ncol(cit00))]
colnames(cit0)[c(2,8)]=colnames(cit00)[c(2,8)]=c('Title','Citation')
cit=rbind(cit0,cit00)
cit=cit[!duplicated(cit),]
genomics=merge(cit,dat,by='Title')
genomics$Citation=as.numeric(as.character(genomics$Citation))
dat2=allp[allp$doi %in% dat$DOI|allp$pmid %in% dat$PubMed.ID,]
dat2$citation=rep(NA,nrow(dat2))
for (i in seq(nrow(dat2))) {
lol=c(which(genomics$DOI==dat2$doi[i]),which(genomics$PubMed.ID==dat2$pmid[i]))
if (length(lol)>0) dat2$citation[i]=genomics$Citation[lol]
}
dat2=allp[allp$doi %in% dat$DOI|allp$pmid %in% dat$PubMed.ID,]
dat2$citation=rep(NA,nrow(dat2))
for (i in seq(nrow(dat2))) {
lol=c(which(genomics$DOI==dat2$doi[i]),which(genomics$PubMed.ID==dat2$pmid[i]))
if (length(lol)>0) dat2$citation[i]=genomics$Citation[lol]
}
dat2=dat2[!is.na(dat2$citation),]
dat2$citation=as.numeric(as.character(dat2$citation))
first_quartile_citation=dat2[order(dat2$citation,decreasing=T)[1:round(1*nrow(dat2)/4)],]
View(first_quartile_citation)
china_pubmed = read_csv("china_genomics.csv")
china=first_quartile_citation$pvalue[(allp$pmid %in% china_pubmed$EntrezUID| allp$doi %in% china_pubmed$DOI)]
china=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% china_pubmed$EntrezUID| first_quartile_citation$doi %in% china_pubmed$DOI)]
us_pubmed = read_csv("us_genomics.csv")
us=allp$pvalue[first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% us_pubmed$EntrezUID| first_quartile_citation$doi %in% us_pubmed$DOI)]]
uk_pubmed = read_csv("uk_genomics.csv")
uk=allp$pvalue[first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% uk_pubmed$EntrezUID| first_quartile_citation$doi %in% uk_pubmed$DOI)]]
global_pubmed = read_csv("genomics.csv")
global=allp$pvalue[first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% global_pubmed$EntrezUID| first_quartile_citation$doi %in% global_pubmed$DOI)]]
us=first_quartile_citation$pvalue[first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% us_pubmed$EntrezUID| first_quartile_citation$doi %in% us_pubmed$DOI)]]
uk=first_quartile_citation$pvalue[first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% uk_pubmed$EntrezUID| first_quartile_citation$doi %in% uk_pubmed$DOI)]]
global=allp$pvalue[first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% global_pubmed$EntrezUID| first_quartile_citation$doi %in% global_pubmed$DOI)]]
us_pubmed = read_csv("us_genomics.csv")
us=first_quartile_citation$pvalue[first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% us_pubmed$EntrezUID| first_quartile_citation$doi %in% us_pubmed$DOI)]]
global_pubmed = read_csv("genomics.csv")
global=first_quartile_citation$pvalue[first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% global_pubmed$EntrezUID| first_quartile_citation$doi %in% global_pubmed$DOI)]]
us=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% us_pubmed$EntrezUID| first_quartile_citation$doi %in% us_pubmed$DOI)]
uk=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% uk_pubmed$EntrezUID| first_quartile_citation$doi %in% uk_pubmed$DOI)]
global=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% global_pubmed$EntrezUID| first_quartile_citation$doi %in% global_pubmed$DOI)]
plot(density(global))
plot(density(global),ylim=c(0,0.06))
plot(density(global),xlim=c(0,0.06))
lines(density(china),xlim=c(0,0.06))
samp=min(c(length(china),length(us),length(global)))
p_values=c(prop.test(c(length(global[global<=0.025]), length(china[china<=0.025])), c(length(global[global<=0.05]), length(china[china<=0.05])))$p.value,
prop.test(c(length(global[global<=0.025]), length(us[us<=0.025])), c(length(us[us<=0.05]), length(us[us<=0.05])))$p.value)
data = data.frame(y=c(),x=c(),z=c())
data=rbind(data,undersampler(global,samp,'Global'))
data=rbind(data,undersampler(china,samp,'China'))
data=rbind(data,undersampler(us,samp,'United States'))
plotre=ggplot(data=data, aes(x=x, y=y,group=z,colour=z))+
geom_line(size=1.2)+ ggtitle("Genomics") +
theme_bw() + theme(legend.position="bottom",panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+
labs(x = "p-value",y='Density',colour='Country')
prop.test(c(length(global[global<=0.025]), length(china[china<=0.025])), c(length(global[global<=0.05]), length(china[china<=0.05])))$p.value
prop.test(c(length(global[global<=0.025]), length(us[us<=0.025])), c(length(us[us<=0.05]), length(us[us<=0.05])))$p.value
us
samp=min(c(length(china),length(us),length(global)))
p_values=c(prop.test(c(length(global[global<=0.025]), length(china[china<=0.025])), c(length(global[global<=0.05]), length(china[china<=0.05])))$p.value,
prop.test(c(length(global[global<=0.025]), length(us[us<=0.025])), c(length(global[global<=0.05]), length(us[us<=0.05])))$p.value)
data = data.frame(y=c(),x=c(),z=c())
data=rbind(data,undersampler(global,samp,'Global'))
data=rbind(data,undersampler(china,samp,'China'))
data=rbind(data,undersampler(us,samp,'United States'))
plotre=ggplot(data=data, aes(x=x, y=y,group=z,colour=z))+
geom_line(size=1.2)+ ggtitle("Genomics") +
theme_bw() + theme(legend.position="bottom",panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+
labs(x = "p-value",y='Density',colour='Country')
plotre
first_quartile_citation=dat2[order(dat2$citation,decreasing=T)[round(1*nrow(dat2)/4+1):round(2*nrow(dat2)/4)],]
china=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% china_pubmed$EntrezUID| first_quartile_citation$doi %in% china_pubmed$DOI)]
us=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% us_pubmed$EntrezUID| first_quartile_citation$doi %in% us_pubmed$DOI)]
global=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% global_pubmed$EntrezUID| first_quartile_citation$doi %in% global_pubmed$DOI)]
samp=min(c(length(china),length(us),length(global)))
p_values=c(prop.test(c(length(global[global<=0.025]), length(china[china<=0.025])), c(length(global[global<=0.05]), length(china[china<=0.05])))$p.value,
prop.test(c(length(global[global<=0.025]), length(us[us<=0.025])), c(length(global[global<=0.05]), length(us[us<=0.05])))$p.value)
data = data.frame(y=c(),x=c(),z=c())
data=rbind(data,undersampler(global,samp,'Global'))
data=rbind(data,undersampler(china,samp,'China'))
data=rbind(data,undersampler(us,samp,'United States'))
plotre=ggplot(data=data, aes(x=x, y=y,group=z,colour=z))+
geom_line(size=1.2)+ ggtitle("Genomics") +
theme_bw() + theme(legend.position="bottom",panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+
labs(x = "p-value",y='Density',colour='Country')
plotre
first_quartile_citation=dat2[order(dat2$citation,decreasing=T)[round(2*nrow(dat2)/4+1):round(3*nrow(dat2)/4)],]
china_pubmed = read_csv("china_genomics.csv")
china=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% china_pubmed$EntrezUID| first_quartile_citation$doi %in% china_pubmed$DOI)]
us_pubmed = read_csv("us_genomics.csv")
us=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% us_pubmed$EntrezUID| first_quartile_citation$doi %in% us_pubmed$DOI)]
# uk_pubmed = read_csv("uk_genomics.csv")
# uk=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% uk_pubmed$EntrezUID| first_quartile_citation$doi %in% uk_pubmed$DOI)]
global_pubmed = read_csv("genomics.csv")
global=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% global_pubmed$EntrezUID| first_quartile_citation$doi %in% global_pubmed$DOI)]
samp=min(c(length(china),length(us),length(global)))
p_values=c(prop.test(c(length(global[global<=0.025]), length(china[china<=0.025])), c(length(global[global<=0.05]), length(china[china<=0.05])))$p.value,
prop.test(c(length(global[global<=0.025]), length(us[us<=0.025])), c(length(global[global<=0.05]), length(us[us<=0.05])))$p.value)
data = data.frame(y=c(),x=c(),z=c())
data=rbind(data,undersampler(global,samp,'Global'))
data=rbind(data,undersampler(china,samp,'China'))
data=rbind(data,undersampler(us,samp,'United States'))
plotre=ggplot(data=data, aes(x=x, y=y,group=z,colour=z))+
geom_line(size=1.2)+ ggtitle("Genomics") +
theme_bw() + theme(legend.position="bottom",panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+
labs(x = "p-value",y='Density',colour='Country')
plotre
first_quartile_citation=dat2[order(dat2$citation,decreasing=T)[round(3*nrow(dat2)/4+1):nrow(dat2)],]
china_pubmed = read_csv("china_genomics.csv")
china=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% china_pubmed$EntrezUID| first_quartile_citation$doi %in% china_pubmed$DOI)]
us_pubmed = read_csv("us_genomics.csv")
us=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% us_pubmed$EntrezUID| first_quartile_citation$doi %in% us_pubmed$DOI)]
# uk_pubmed = read_csv("uk_genomics.csv")
# uk=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% uk_pubmed$EntrezUID| first_quartile_citation$doi %in% uk_pubmed$DOI)]
global_pubmed = read_csv("genomics.csv")
global=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% global_pubmed$EntrezUID| first_quartile_citation$doi %in% global_pubmed$DOI)]
samp=min(c(length(china),length(us),length(global)))
p_values=c(prop.test(c(length(global[global<=0.025]), length(china[china<=0.025])), c(length(global[global<=0.05]), length(china[china<=0.05])))$p.value,
prop.test(c(length(global[global<=0.025]), length(us[us<=0.025])), c(length(global[global<=0.05]), length(us[us<=0.05])))$p.value)
data = data.frame(y=c(),x=c(),z=c())
data=rbind(data,undersampler(global,samp,'Global'))
data=rbind(data,undersampler(china,samp,'China'))
data=rbind(data,undersampler(us,samp,'United States'))
plotre=ggplot(data=data, aes(x=x, y=y,group=z,colour=z))+
geom_line(size=1.2)+ ggtitle("Genomics") +
theme_bw() + theme(legend.position="bottom",panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+
labs(x = "p-value",y='Density',colour='Country')
plotre
dat2=allp[allp$doi %in% dat$DOI|allp$pmid %in% dat$PubMed.ID,]
dat2=dat2[dat2$journal %in% journal_if_information$ABBREV,]
dat2$IF=rep(NA,nrow(dat2))
journal_if_information$meanIF=rowMeans(apply(journal_if_information[,4:9],2,as.numeric),na.rm=T)
# journal_if_information$`2013/2014`=as.numeric(as.character(journal_if_information$`2013/2014`))
for (i in seq(nrow(dat2))) {
lol=which(journal_if_information$JOURNAL==dat2$journal[i])
if (length(lol)>0) dat2$IF[i]=journal_if_information$meanIF[lol]
}
dat2=dat2[!is.na(dat2$IF),]
dat2$IF=as.numeric(as.character(dat2$IF))
first_quartile_citation=dat2[order(dat2$IF,decreasing=T)[1:round(1*nrow(dat2)/4)],]
samp=min(c(length(china),length(us),length(global)))
p_values=c(prop.test(c(length(global[global<=0.025]), length(china[china<=0.025])), c(length(global[global<=0.05]), length(china[china<=0.05])))$p.value,
prop.test(c(length(global[global<=0.025]), length(us[us<=0.025])), c(length(global[global<=0.05]), length(us[us<=0.05])))$p.value)
data = data.frame(y=c(),x=c(),z=c())
data=rbind(data,undersampler(global,samp,'Global'))
data=rbind(data,undersampler(china,samp,'China'))
data=rbind(data,undersampler(us,samp,'United States'))
plotre=ggplot(data=data, aes(x=x, y=y,group=z,colour=z))+
geom_line(size=1.2)+ ggtitle("Genomics") +
theme_bw() + theme(legend.position="bottom",panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+
labs(x = "p-value",y='Density',colour='Country')
plotre
first_quartile_citation=dat2[order(dat2$IF,decreasing=T)[round(1*nrow(dat2)/4+1):round(2*nrow(dat2)/4)],]
samp=min(c(length(china),length(us),length(global)))
p_values=c(prop.test(c(length(global[global<=0.025]), length(china[china<=0.025])), c(length(global[global<=0.05]), length(china[china<=0.05])))$p.value,
prop.test(c(length(global[global<=0.025]), length(us[us<=0.025])), c(length(global[global<=0.05]), length(us[us<=0.05])))$p.value)
data = data.frame(y=c(),x=c(),z=c())
data=rbind(data,undersampler(global,samp,'Global'))
data=rbind(data,undersampler(china,samp,'China'))
data=rbind(data,undersampler(us,samp,'United States'))
plotre=ggplot(data=data, aes(x=x, y=y,group=z,colour=z))+
geom_line(size=1.2)+ ggtitle("Genomics") +
theme_bw() + theme(legend.position="bottom",panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+
labs(x = "p-value",y='Density',colour='Country')
plotre
first_quartile_citation=dat2[order(dat2$IF,decreasing=T)[round(2*nrow(dat2)/4+1):round(3*nrow(dat2)/4)],]
first_quartile_citation=dat2[order(dat2$IF,decreasing=T)[1:round(1*nrow(dat2)/4)],]
china_pubmed = read_csv("china_genomics.csv")
china=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% china_pubmed$EntrezUID| first_quartile_citation$doi %in% china_pubmed$DOI)]
us_pubmed = read_csv("us_genomics.csv")
us=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% us_pubmed$EntrezUID| first_quartile_citation$doi %in% us_pubmed$DOI)]
# uk_pubmed = read_csv("uk_genomics.csv")
# uk=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% uk_pubmed$EntrezUID| first_quartile_citation$doi %in% uk_pubmed$DOI)]
global_pubmed = read_csv("genomics.csv")
global=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% global_pubmed$EntrezUID| first_quartile_citation$doi %in% global_pubmed$DOI)]
samp=min(c(length(china),length(us),length(global)))
p_values=c(prop.test(c(length(global[global<=0.025]), length(china[china<=0.025])), c(length(global[global<=0.05]), length(china[china<=0.05])))$p.value,
prop.test(c(length(global[global<=0.025]), length(us[us<=0.025])), c(length(global[global<=0.05]), length(us[us<=0.05])))$p.value)
data = data.frame(y=c(),x=c(),z=c())
data=rbind(data,undersampler(global,samp,'Global'))
data=rbind(data,undersampler(china,samp,'China'))
data=rbind(data,undersampler(us,samp,'United States'))
ggplot(data=data, aes(x=x, y=y,group=z,colour=z))+
geom_line(size=1.2)+ ggtitle("Genomics") +
theme_bw() + theme(legend.position="bottom",panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+
labs(x = "p-value",y='Density',colour='Country')
first_quartile_citation=dat2[order(dat2$IF,decreasing=T)[round(1*nrow(dat2)/4+1):round(2*nrow(dat2)/4)],]
china=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% china_pubmed$EntrezUID| first_quartile_citation$doi %in% china_pubmed$DOI)]
us=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% us_pubmed$EntrezUID| first_quartile_citation$doi %in% us_pubmed$DOI)]
global=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% global_pubmed$EntrezUID| first_quartile_citation$doi %in% global_pubmed$DOI)]
samp=min(c(length(china),length(us),length(global)))
us_pubmed = read_csv("us_genomics.csv")
us=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% us_pubmed$EntrezUID| first_quartile_citation$doi %in% us_pubmed$DOI)]
china_pubmed = read_csv("china_genomics.csv")
china=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% china_pubmed$EntrezUID| first_quartile_citation$doi %in% china_pubmed$DOI)]
first_quartile_citation=dat2[order(dat2$IF,decreasing=T)[round(1*nrow(dat2)/4+1):round(2*nrow(dat2)/4)],]
china_pubmed = read_csv("china_genomics.csv")
china=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% china_pubmed$EntrezUID| first_quartile_citation$doi %in% china_pubmed$DOI)]
us_pubmed = read_csv("us_genomics.csv")
us=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% us_pubmed$EntrezUID| first_quartile_citation$doi %in% us_pubmed$DOI)]
# uk_pubmed = read_csv("uk_genomics.csv")
# uk=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% uk_pubmed$EntrezUID| first_quartile_citation$doi %in% uk_pubmed$DOI)]
global_pubmed = read_csv("genomics.csv")
global=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% global_pubmed$EntrezUID| first_quartile_citation$doi %in% global_pubmed$DOI)]
first_quartile_citation=dat2[order(dat2$IF,decreasing=T)[round(2*nrow(dat2)/4+1):round(3*nrow(dat2)/4)],]
china_pubmed = read_csv("china_genomics.csv")
china=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% china_pubmed$EntrezUID| first_quartile_citation$doi %in% china_pubmed$DOI)]
us_pubmed = read_csv("us_genomics.csv")
us=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% us_pubmed$EntrezUID| first_quartile_citation$doi %in% us_pubmed$DOI)]
# uk_pubmed = read_csv("uk_genomics.csv")
# uk=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% uk_pubmed$EntrezUID| first_quartile_citation$doi %in% uk_pubmed$DOI)]
global_pubmed = read_csv("genomics.csv")
global=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% global_pubmed$EntrezUID| first_quartile_citation$doi %in% global_pubmed$DOI)]
samp=min(c(length(china),length(us),length(global)))
p_values=c(prop.test(c(length(global[global<=0.025]), length(china[china<=0.025])), c(length(global[global<=0.05]), length(china[china<=0.05])))$p.value,
prop.test(c(length(global[global<=0.025]), length(us[us<=0.025])), c(length(global[global<=0.05]), length(us[us<=0.05])))$p.value)
data = data.frame(y=c(),x=c(),z=c())
data=rbind(data,undersampler(global,samp,'Global'))
data=rbind(data,undersampler(china,samp,'China'))
data=rbind(data,undersampler(us,samp,'United States'))
ggplot(data=data, aes(x=x, y=y,group=z,colour=z))+
geom_line(size=1.2)+ ggtitle("Genomics") +
theme_bw() + theme(legend.position="bottom",panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+
labs(x = "p-value",y='Density',colour='Country')
first_quartile_citation=dat2[order(dat2$IF,decreasing=T)[1:round(1*nrow(dat2)/4)],]
china_pubmed = read_csv("china_genomics.csv")
china=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% china_pubmed$EntrezUID| first_quartile_citation$doi %in% china_pubmed$DOI)]
us_pubmed = read_csv("us_genomics.csv")
us=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% us_pubmed$EntrezUID| first_quartile_citation$doi %in% us_pubmed$DOI)]
# uk_pubmed = read_csv("uk_genomics.csv")
# uk=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% uk_pubmed$EntrezUID| first_quartile_citation$doi %in% uk_pubmed$DOI)]
global_pubmed = read_csv("genomics.csv")
global=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% global_pubmed$EntrezUID| first_quartile_citation$doi %in% global_pubmed$DOI)]
first_quartile_citation=dat2[order(dat2$citation,decreasing=T)[1:round(1*nrow(dat2)/4)],]
china_pubmed = read_csv("china_genomics.csv")
china=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% china_pubmed$EntrezUID| first_quartile_citation$doi %in% china_pubmed$DOI)]
us_pubmed = read_csv("us_genomics.csv")
us=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% us_pubmed$EntrezUID| first_quartile_citation$doi %in% us_pubmed$DOI)]
# uk_pubmed = read_csv("uk_genomics.csv")
# uk=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% uk_pubmed$EntrezUID| first_quartile_citation$doi %in% uk_pubmed$DOI)]
global_pubmed = read_csv("genomics.csv")
global=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% global_pubmed$EntrezUID| first_quartile_citation$doi %in% global_pubmed$DOI)]
samp=min(c(length(china),length(us),length(global)))
p_values=c(prop.test(c(length(global[global<=0.025]), length(china[china<=0.025])), c(length(global[global<=0.05]), length(china[china<=0.05])))$p.value,
prop.test(c(length(global[global<=0.025]), length(us[us<=0.025])), c(length(global[global<=0.05]), length(us[us<=0.05])))$p.value)
data = data.frame(y=c(),x=c(),z=c())
data=rbind(data,undersampler(global,samp,'Global'))
data=rbind(data,undersampler(china,samp,'China'))
data=rbind(data,undersampler(us,samp,'United States'))
ggplot(data=data, aes(x=x, y=y,group=z,colour=z))+
geom_line(size=1.2)+ ggtitle("Genomics") +
theme_bw() + theme(legend.position="bottom",panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+
labs(x = "p-value",y='Density',colour='Country')
dat2=allp[allp$doi %in% dat$DOI|allp$pmid %in% dat$PubMed.ID,]
dat2$citation=rep(NA,nrow(dat2))
for (i in seq(nrow(dat2))) {
lol=c(which(genomics$DOI==dat2$doi[i]),which(genomics$PubMed.ID==dat2$pmid[i]))
if (length(lol)>0) dat2$citation[i]=genomics$Citation[lol]
}
dat2=dat2[!is.na(dat2$citation),]
dat2$citation=as.numeric(as.character(dat2$citation))
first_quartile_citation=dat2[order(dat2$citation,decreasing=T)[1:round(1*nrow(dat2)/4)],]
china_pubmed = read_csv("china_genomics.csv")
china=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% china_pubmed$EntrezUID| first_quartile_citation$doi %in% china_pubmed$DOI)]
us_pubmed = read_csv("us_genomics.csv")
us=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% us_pubmed$EntrezUID| first_quartile_citation$doi %in% us_pubmed$DOI)]
# uk_pubmed = read_csv("uk_genomics.csv")
# uk=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% uk_pubmed$EntrezUID| first_quartile_citation$doi %in% uk_pubmed$DOI)]
global_pubmed = read_csv("genomics.csv")
global=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% global_pubmed$EntrezUID| first_quartile_citation$doi %in% global_pubmed$DOI)]
samp=min(c(length(china),length(us),length(global)))
p_values=c(prop.test(c(length(global[global<=0.025]), length(china[china<=0.025])), c(length(global[global<=0.05]), length(china[china<=0.05])))$p.value,
prop.test(c(length(global[global<=0.025]), length(us[us<=0.025])), c(length(global[global<=0.05]), length(us[us<=0.05])))$p.value)
data = data.frame(y=c(),x=c(),z=c())
data=rbind(data,undersampler(global,samp,'Global'))
data=rbind(data,undersampler(china,samp,'China'))
data=rbind(data,undersampler(us,samp,'United States'))
ggplot(data=data, aes(x=x, y=y,group=z,colour=z))+
geom_line(size=1.2)+ ggtitle("Genomics") +
theme_bw() + theme(legend.position="bottom",panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+
labs(x = "p-value",y='Density',colour='Country')
dat=rbind(data.frame(read_csv("proteomics_scopus_1.csv")),data.frame(read_csv("proteomics_scopus_2.csv")))
dat=dat[!duplicated(dat),]
cit0 = data.frame(read_csv("proteomics_citation_1.csv"))[-c(1:6),]
cit00 = data.frame(read_csv("proteomics_citation_2.csv"))[-c(1:6),]
cit0=cit0[,c(1:7,ncol(cit0))]
cit00=cit00[,c(1:7,ncol(cit00))]
colnames(cit0)[c(2,8)]=colnames(cit00)[c(2,8)]=c('Title','Citation')
cit=rbind(cit0,cit00)
cit=cit[!duplicated(cit),]
proteomics=merge(cit,dat,by='Title')
proteomics$Citation=as.numeric(as.character(proteomics$Citation))
dat2=allp[allp$doi %in% dat$DOI|allp$pmid %in% dat$PubMed.ID,]
dat2$citation=rep(NA,nrow(dat2))
for (i in seq(nrow(dat2))) {
lol=c(which(proteomics$DOI==dat2$doi[i]),which(proteomics$PubMed.ID==dat2$pmid[i]))
if (length(lol)>0) dat2$citation[i]=proteomics$Citation[lol]
}
dat2=dat2[!is.na(dat2$citation),]
dat2$citation=as.numeric(as.character(dat2$citation))
first_quartile_citation=dat2[order(dat2$citation,decreasing=T)[1:round(1*nrow(dat2)/4)],]
china_pubmed = read_csv("china_proteomics.csv")
china=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% china_pubmed$EntrezUID| first_quartile_citation$doi %in% china_pubmed$DOI)]
us_pubmed = read_csv("us_proteomics.csv")
us=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% us_pubmed$EntrezUID| first_quartile_citation$doi %in% us_pubmed$DOI)]
global_pubmed = read_csv("proteomics.csv")
global=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% global_pubmed$EntrezUID| first_quartile_citation$doi %in% global_pubmed$DOI)]
samp=min(c(length(china),length(us),length(global)))
p_values=c(prop.test(c(length(global[global<=0.025]), length(china[china<=0.025])), c(length(global[global<=0.05]), length(china[china<=0.05])))$p.value,
prop.test(c(length(global[global<=0.025]), length(us[us<=0.025])), c(length(global[global<=0.05]), length(us[us<=0.05])))$p.value)
data = data.frame(y=c(),x=c(),z=c())
data=rbind(data,undersampler(global,samp,'Global'))
data=rbind(data,undersampler(china,samp,'China'))
data=rbind(data,undersampler(us,samp,'United States'))
ggplot(data=data, aes(x=x, y=y,group=z,colour=z))+
geom_line(size=1.2)+ ggtitle("Genomics") +
theme_bw() + theme(legend.position="bottom",panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+
labs(x = "p-value",y='Density',colour='Country')
dat=rbind(data.frame(read_csv("genomics_scopus_1.csv")),data.frame(read_csv("genomics_scopus_2.csv")))
dat=dat[!duplicated(dat),]
cit0 = data.frame(read_csv("genomics_citation_1.csv"))[-c(1:6),]
cit00 = data.frame(read_csv("genomics_citation_2.csv"))[-c(1:6),]
cit0=cit0[,c(1:7,ncol(cit0))]
cit00=cit00[,c(1:7,ncol(cit00))]
colnames(cit0)[c(2,8)]=colnames(cit00)[c(2,8)]=c('Title','Citation')
cit=rbind(cit0,cit00)
cit=cit[!duplicated(cit),]
genomics=merge(cit,dat,by='Title')
genomics$Citation=as.numeric(as.character(genomics$Citation))
dat2=allp[allp$doi %in% dat$DOI|allp$pmid %in% dat$PubMed.ID,]
dat2$citation=rep(NA,nrow(dat2))
for (i in seq(nrow(dat2))) {
lol=c(which(genomics$DOI==dat2$doi[i]),which(genomics$PubMed.ID==dat2$pmid[i]))
if (length(lol)>0) dat2$citation[i]=genomics$Citation[lol]
}
dat2=dat2[!is.na(dat2$citation),]
dat2$citation=as.numeric(as.character(dat2$citation))
first_quartile_citation=dat2[order(dat2$citation,decreasing=T)[1:round(1*nrow(dat2)/4)],]
china_pubmed = read_csv("china_genomics.csv")
china1=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% china_pubmed$EntrezUID| first_quartile_citation$doi %in% china_pubmed$DOI)]
us_pubmed = read_csv("us_genomics.csv")
us1=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% us_pubmed$EntrezUID| first_quartile_citation$doi %in% us_pubmed$DOI)]
global_pubmed = read_csv("genomics.csv")
global1=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% global_pubmed$EntrezUID| first_quartile_citation$doi %in% global_pubmed$DOI)]
dat=data.frame(read_csv("metabolomics_scopus.csv"))
cit0 = data.frame(read_csv("metabolomics_citation.csv"))[-c(1:6),]
cit0=cit0[,c(1:7,ncol(cit0))]
colnames(cit0)[c(2,8)]=c('Title','Citation')
cit=cit0
cit=cit[!duplicated(cit),]
metabolomics=merge(cit,dat,by='Title')
metabolomics$Citation=as.numeric(as.character(metabolomics$Citation))
dat2=allp[allp$doi %in% dat$DOI|allp$pmid %in% dat$PubMed.ID,]
dat2$citation=rep(NA,nrow(dat2))
for (i in seq(nrow(dat2))) {
lol=c(which(metabolomics$DOI==dat2$doi[i]),which(metabolomics$PubMed.ID==dat2$pmid[i]))
if (length(lol)>0) dat2$citation[i]=metabolomics$Citation[lol]
}
dat2=dat2[!is.na(dat2$citation),]
dat2$citation=as.numeric(as.character(dat2$citation))
first_quartile_citation=dat2[order(dat2$citation,decreasing=T)[1:round(1*nrow(dat2)/4)],]
china_pubmed = read_csv("china_metabolomics.csv")
china2=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% china_pubmed$EntrezUID| first_quartile_citation$doi %in% china_pubmed$DOI)]
us_pubmed = read_csv("us_metabolomics.csv")
us2=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% us_pubmed$EntrezUID| first_quartile_citation$doi %in% us_pubmed$DOI)]
global_pubmed = read_csv("metabolomics.csv")
global2=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% global_pubmed$EntrezUID| first_quartile_citation$doi %in% global_pubmed$DOI)]
dat=rbind(data.frame(read_csv("proteomics_scopus_1.csv")),data.frame(read_csv("proteomics_scopus_2.csv")))
dat=dat[!duplicated(dat),]
cit0 = data.frame(read_csv("proteomics_citation_1.csv"))[-c(1:6),]
cit00 = data.frame(read_csv("proteomics_citation_2.csv"))[-c(1:6),]
cit0=cit0[,c(1:7,ncol(cit0))]
cit00=cit00[,c(1:7,ncol(cit00))]
colnames(cit0)[c(2,8)]=colnames(cit00)[c(2,8)]=c('Title','Citation')
cit=rbind(cit0,cit00)
cit=cit[!duplicated(cit),]
proteomics=merge(cit,dat,by='Title')
proteomics$Citation=as.numeric(as.character(proteomics$Citation))
dat2=allp[allp$doi %in% dat$DOI|allp$pmid %in% dat$PubMed.ID,]
dat2$citation=rep(NA,nrow(dat2))
for (i in seq(nrow(dat2))) {
lol=c(which(proteomics$DOI==dat2$doi[i]),which(proteomics$PubMed.ID==dat2$pmid[i]))
if (length(lol)>0) dat2$citation[i]=proteomics$Citation[lol]
}
dat2=dat2[!is.na(dat2$citation),]
dat2$citation=as.numeric(as.character(dat2$citation))
first_quartile_citation=dat2[order(dat2$citation,decreasing=T)[1:round(1*nrow(dat2)/4)],]
china_pubmed = read_csv("china_proteomics.csv")
china4=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% china_pubmed$EntrezUID| first_quartile_citation$doi %in% china_pubmed$DOI)]
us_pubmed = read_csv("us_proteomics.csv")
us4=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% us_pubmed$EntrezUID| first_quartile_citation$doi %in% us_pubmed$DOI)]
global_pubmed = read_csv("proteomics.csv")
global4=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% global_pubmed$EntrezUID| first_quartile_citation$doi %in% global_pubmed$DOI)]
dat=rbind(data.frame(read_csv("transcriptomics_scopus_1.csv")),data.frame(read_csv("transcriptomics_scopus_2.csv")))
dat=dat[!duplicated(dat),]
cit0 = data.frame(read_csv("transcriptomics_citation_1.csv"))[-c(1:6),]
cit00 = data.frame(read_csv("transcriptomics_citation_2.csv"))[-c(1:6),]
cit0=cit0[,c(1:7,ncol(cit0))]
cit00=cit00[,c(1:7,ncol(cit00))]
colnames(cit0)[c(2,8)]=colnames(cit00)[c(2,8)]=c('Title','Citation')
cit=rbind(cit0,cit00)
cit=cit[!duplicated(cit),]
transcriptomics=merge(cit,dat,by='Title')
transcriptomics$Citation=as.numeric(as.character(transcriptomics$Citation))
dat2=allp[allp$doi %in% dat$DOI|allp$pmid %in% dat$PubMed.ID,]
dat2$citation=rep(NA,nrow(dat2))
for (i in seq(nrow(dat2))) {
lol=c(which(transcriptomics$DOI==dat2$doi[i]),which(transcriptomics$PubMed.ID==dat2$pmid[i]))
if (length(lol)>0) dat2$citation[i]=transcriptomics$Citation[lol]
}
dat2=dat2[!is.na(dat2$citation),]
dat2$citation=as.numeric(as.character(dat2$citation))
first_quartile_citation=dat2[order(dat2$citation,decreasing=T)[1:round(1*nrow(dat2)/4)],]
china_pubmed = read_csv("china_transcriptomics.csv")
china3=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% china_pubmed$EntrezUID| first_quartile_citation$doi %in% china_pubmed$DOI)]
us_pubmed = read_csv("us_transcriptomics.csv")
us3=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% us_pubmed$EntrezUID| first_quartile_citation$doi %in% us_pubmed$DOI)]
global_pubmed = read_csv("transcriptomics.csv")
global3=first_quartile_citation$pvalue[(first_quartile_citation$pmid %in% global_pubmed$EntrezUID| first_quartile_citation$doi %in% global_pubmed$DOI)]
us=c(us1,us2,us3,us4)
global=c(global1,global2,global3,global4)
china=c(china1,china2,china3,china4)
samp=min(c(length(china),length(us),length(global)))
p_values=c(prop.test(c(length(global[global<=0.025]), length(china[china<=0.025])), c(length(global[global<=0.05]), length(china[china<=0.05])))$p.value,
prop.test(c(length(global[global<=0.025]), length(us[us<=0.025])), c(length(global[global<=0.05]), length(us[us<=0.05])))$p.value)
data = data.frame(y=c(),x=c(),z=c())
data=rbind(data,undersampler(global,samp,'Global'))
data=rbind(data,undersampler(china,samp,'China'))
data=rbind(data,undersampler(us,samp,'United States'))
ggplot(data=data, aes(x=x, y=y,group=z,colour=z))+
geom_line(size=1.2)+ ggtitle("Genomics") +
theme_bw() + theme(legend.position="bottom",panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+
labs(x = "p-value",y='Density',colour='Country')
install.packages("OutliersO3")
load("C:/Bruker/TopSpin3.2/data/MNavarro_femtes_IRSI/data_analysis/resultats_paper_3.RData")
O3s <- O3plot(profiling_names_corrected$final_output$shift, mm="HDo", Alphas=0.05, Coefs=6)
library(OutliersO3)
O3s <- O3plot(profiling_names_corrected$final_output$shift, mm="HDo", Alphas=0.05, Coefs=6)
O3s <- O3plot(profiling_names_corrected$final_output$shift[,is.na(profiling_names_corrected$final_output$shift[1,])], mm="HDo", Alphas=0.05, Coefs=6)
asd=profiling_names_corrected$final_output$shift[,is.na(profiling_names_corrected$final_output$shift[1,])]
asd=profiling_names_corrected$final_output$shift[,!is.na(profiling_names_corrected$final_output$shift[1,])]
O3s <- O3plot(asd, mm="HDo", Alphas=0.05, Coefs=6)
O3s <- O3plot(asd[,1:5], mm="HDo", Alphas=0.05, Coefs=6)
ibrary(gridExtra)
grid.arrange(O3s$gO3, O3s$gpcp, ncol=1)
library(grid)
library(gridExtra)
library(grid)
ibrary(gridExtra)
grid.arrange(O3s$gO3, O3s$gpcp, ncol=1)
O3s <- O3plot(asd[,c(11,13,14,16)], mm="HDo", Alphas=0.05, Coefs=6)
grid.arrange(O3s$gO3, O3s$gpcp, ncol=1)
